---
title: "七个高效的文本编辑习惯(翻译)"
date: 2024-03-22T14:48:11+08:00
tags: [""]
categories: ""
author: "Jiao shijie"
draft: false
hidemeta: true
math: false
---

Original author: Bram Moolenaar

Date: November 2000

Source: [Seven habits of effective text editing](https://moolenaar.net/habits.html)

如果你经常编辑纯文本文件(比如: 写代码或HTML), 你可以通过使用一个好的编辑器并
高效的使用它来节省大量的时间. 这篇文章将提供一些方法来使你更加快速和更少的错误.

我们将使用开源的文本编辑器Vim(Vi IMproved)来展示这些高效编辑的方法, 当然这也
适用于其它的文本编辑器. 选择一个正确的编辑器是迈向高效编辑的第一步. 关于什么样
的编辑器最适合你这样的讨论可能会浪费很多时间, 所以在这里不讨论这个问题. 但如果
你不知道要使用什么编辑器或对你现在使用的编辑器不满意, 可以尝试一下Vim; 你不会失望的.

[Vim命令和选项使用`this (font)`显示]

## Part 1: 编辑一个文件

### 1. 快速的在文件中移动

大部分的时间我们是阅读文件, 检查错误和寻找一个位置来进行编辑, 而不是输入文本和
改变文本. 我们经常浏览整个文件, 因此我们应该学习如何快速的做这一件事.

你可能经常想要搜索一段文本在文件的什么位置, 或使用了一个特定单词或短语的所有行.
你可以简单的使用搜索命令`/pattern`来查找文本, 但这还有一些更高明的方式:

- 如果你想要查找一个单词是否出现在该文件的其它地方, 使用`*`命令, 它将获取光标下
的单词并搜索这个单词出现的下一个位置.
- 如果你设置了`incsearch`选项, Vim将实时地匹配你输入的字符. 这使你能很快的发现
你输入的字符的错误.
- 如果你设置了`hlsearch`选项, Vim将高亮全部的匹配结果, 这将使你能够知道搜索命令
会把光标放在什么地方. 在代码中这个功能可以显示一个变量都在哪里被使用了, 因此
你可以不用移动光标来查看每一个匹配项.

在一个结构化的文件中有更多快速移动的方式. Vim对于C文本(或类C, C++和Java)有一些
特定的命令.

- 使用`%`既可以在一对括号之间跳转, 也可以在`#if`和`#endif`之间跳转.
事实上, `%`还可以跳转在其他不同的模式. 在检查`()`和`{}`是否正确的匹配时非常有用.
- 使用`[{`可以跳转到现在代码块开始的{.
- 使用`gd`可以跳转到光标下变量的定义处.

当然这些命令还有很多. 重点是你需要指导这些命令. 你可能对此表示反对, 你不可能
知道这全部的命令-这有非常多的关于移动的命令, 有些简单, 有些非常灵巧-学习全部的
这些命令将要花费几周的时间. 然而, 你并不需要学习全部的这些命令. 你只需要学习
那些能够提高你编辑效率的命令就可以了.

这有3个基础的步骤:

1. 当你进行编辑的时候, 注意观察你经常重复什么样的编辑操作和这样的操作会花费多少时间.
2. 寻找是否有一个编辑命令可以更快的完成这个操作. 可以通过读文档,
询问朋友或寻找其他人是如何做这样的操作的.
3. 有意识的在下一次编辑中使用这个命令. 然后训练自己做到可以不用思考就输入它.

让我们用一个例子来展示如何使用这些步骤:

1. 比如你发现当你书写C程序时, 你经常花费很多时间来寻找一个函数在哪里定义.
你现在使用`*`命令来搜索函数的名字, 但这样会有很多的匹配项-大量都是函数被使用的匹配项而不是函数定义的匹配项. 然后你想要寻找一个方式来让这操作变的更快.
2. 通过浏览帮助文档(quick reference)你发现了一个跳转标签(tags)的方法可以完成
这个操作. 这个文档记录了如何跳转到一个函数的定义, 这正是你在寻找的.
3. 你是用ctags程序(作为Vim的依赖进行安装的)创建了一个tags文件, 并进行了尝试.
你学会了使用`Ctrl-]`命令并发现通过使用它你节省了大量的时间. 为了使创建tags文件
更方便, 你在你的Makefile文件中添加了几行代码来自动的创建tags文件.

有一些事情在你是用上面步骤时要特别注意:

- "我想要完成我的工作, 但我没有时间去查询文档来发现新的命令". 如果你有这样的想法,
你将停留在计算的石器时代. 有些人使用记事本来做所有的工作, 然后很困惑为什么其他人
只需要一半的时间就可以完成他们的工作.
- 不要过度的使用这些步骤. 如果你总是想要找到一个完美的命令来处理你做的每一件小事
, 你的大脑将没有时间去思考你真正要做的工作. 只需要处理那些必需的并且消耗大量时间
的操作, 练习使用这些命令直到你不需要思考就可以使用出它. 这样你就可以更加专注于你
要处理的文本.

在下面的章节将会给出一些很多人都要进行的操作的建议. 你可以将这些建议作为你使用这
**三个步骤**处理你自己编辑操作的一个启发.

### 2. 不要重复的输入相同的东西

我们输入的单词是一个有限的集合, 甚至我们输入的短语和句子也是如此. 这在计算机编程
当中更为明显. 显然, 你不想要输入相同的东西两次.

你经常想要将一个单词换为另一个单词. 如果你要对整个文件做这个操作, 你可以使用
`:s`(substitute)命令. 如果你只是要对一个比较小的范围来做改变, 一个比较快速的操作
是使用`*`命令来发现这个单词出现的下一个位置然后使用`cw`来改变这个单词. 然后使用
`n`来寻找下一个单词和使用`.`(dot)来重复`cw`命令.

`.`命令可以重复上一次的修改. 这个改变可以是插入, 删除和替换文本. 重复(repeat)是
一个非常强大的机制. 如果你围绕这`.`命令组织你的编辑方式, 你会发现很多的改变仅仅
只需要按一下`.`键. 在你使用`.`进行修改时要格外的小心不要做其他的修改, 因为这将
替换你现在正在做的修改. 你可能想要使用`m`命令来标记现在的位置, 在你完成所有的
修改后可以返回到这里.

一些函数或变量名称是非常难以输入的. 你能快速的输入"XpmCreatePixmapFromData"而
没有输入错误或不用再次看它一眼吗? Vim有一个补全机制可以让这件事变的很容易.
它会查看你正在编辑的文件当中的单词和#include'd文件. 你可以输入"XpmCr",
然后按下`CTRL-N`Vim将会将它展开为"XpmCreatePixmapFromData". 这个功能不仅能减少
大量的输入操作, 还能避免输入错误, 从而避免之后编译器给你一个你必需去修理的错误.

当你多次输入一个短语或句子时, 也有一个比较快速的方法. Vim有一个记录宏的机制.
你可以输入`qa`来开始记录宏到a寄存器. 然后你就可以像平常那样输入, 最后按下`q`键
结束记录. 当你想要重复这个记录时可以输入`@a`. 26个英文字母都可以作为记录宏的
寄存器.

记录宏的功能可以做很多不同的操作, 不仅仅是插入文本. 时刻记着使用记录宏当你做重复
操作的时候.

使用记录宏是要小心一件事, 它只是精确的重复你之前的输入. 你必须清除你记录宏所使用
的文本和重复宏的文本是不同的. 向左移动4个字符对你记录宏的文本是正确的, 但对于
重复宏时的文本可能需要使用5个字符才是正确的. 因此通常会使用移动命令来移动到文本
对象(words, sentences)或移动到一个指定的字符.

当你需要重复的命令比较复杂时, 正确的输入一次它们也会变得困难. 因此你需要写一个
脚本或宏来取代记录宏. 为你的代码创建一个模版是非常有用的; 例如, 一个函数头.
你能把它创造的非常智能.

### 3. 当输错时立刻改正

当进行编辑时会经常出现输入错误. 没有人可以避免出错. 这个技巧可以让你快速定位到
错误并更正. 编辑器应该能够帮助你去做这些事情. 但你需要告诉编辑器什么是错的什么
是对的.

很多时候你会一次又一次的犯相同的错误. 你的手指就是不输入你想要的字符. 缩写
(abbreviations)能够帮助你订正这个错误. 举一些例子:

```vim
:abbr Lunix Linux
:abbr accross across
:abbr hte the
```

这些单词将会在你输入完它们后自动更正.

可以使用这个方法通过输入几个字符来将它扩展为长的字符. 这是非常有用的当单词很难
输入时, 而且可以避免输入错误. 例如:

```vim
:abbr pn penguin
:abbr MS mandrake Software
```

然而, 当你不想要扩展这个单词时Vim依然会扩展它, 这将导致你真正想要在你的文本中
输入"MS"时变的非常困难. 所以最好使用完全没有任何意义的短词来使用这个功能.

为了发现你文本中的错误Vim提供了一个智能的文本高亮机制. 这个机制本来是为了
编程语言的语法高亮而设置的, 但它也可以发现和高亮文本中的错误.

语法高亮也可以高亮显示注释. 这听起来不是一个很重要的功能, 但当你一开始使用它
你就会发现它非常有用. 你能快速定位是注释的文本, 但如果它没有像通常情况下那样高亮
(很可能是你忘记了输入注释前缀符). 或看到代码行被高亮显示为注释的颜色
(你应该是忘记了输入高亮的结束符, 比如"\*/"). 这些错误在黑白文本中是非常难发现的,
而且还会浪费大量的时间来修复这些错误.

语法高亮也能够检查不匹配的括号. 一个没有匹配的")"将会以红色背景高亮. 你能使用
`%`命令来看它们彼此和谁比配, 然后在正确的位置插入"("或")".

其他常见的错误也能很快的被发现, 例如, 错误的将`#include <stdio.h>`写成
`#included <stdio.h>`. 在黑白文件中你发现这个错误会非常困难, 而在高亮的文本中
`include`会被高亮而`included`不会.

举一个比较复杂的例子: 对于纯英语文本会使用一个包含全部单词的列表. 没有在列表
当中的单词会被认为是错误的. 对于设置了该语法的文件可以高亮全部没有在列表中的
单词. Vim提供了一些方法可以添加单词到这个单词列表, 然后这些单词就不会再显示
为一个错误了. 这可以像你期望的那样工作在一个单词处理器中. Vim使用脚本来和
它共同工作, 因此你可以进一步的修剪它, 让它仅仅适合你的工作: 例如, 仅仅检查
编程文件中注释的单词拼写错误.

## Part 2: 编辑多个文件

### 4. 很少单独编辑一个文件

人们很少单独编辑一个文件. 大部分情况下, 你会相继编辑很多相关的文件, 甚至是在
同一时间. 你应该发现你所使用的编辑器编辑多个文件的优势来使你的编辑更有效率.

前面提到的tag机制同样可以在多个文件之间使用. 通常的方法是为你工作的整个项目
创建一个tags文件. 你能快速的在这个项目的不同文件之间跳转来发现函数, 结构体和
类型(typedefs)等的定义. 这为你节省的时间相对于手动搜索是巨大的; 创建一个
tags文件是我在浏览一个项目是要做的第一件事.

另一个强大的机制是使用`:grep`命令来在一组文件中发现一个名字全部的出现位置.
Vim将会把所有的匹配项放到一个列表中然后跳转到列表中的第一项. `:cn`命令将会让
你跳转到列表中的下一项. 当你想要改变调用的函数的参数时是非常有用的.

Include的文件包含这有用的信息. 在这些文件中找到一个你需要看的定义会消耗很多时间.
Vim能够分析这些文件, 然后为你搜索那个你想要查看的单词. 这最常用的功能就是发现
一个函数的原型. 将光标放在一个函数名字上面输入`[I`: Vim将会把它匹配到的所有
相同的函数名字和它们所在的文件放在一个列表中向你展示出来. 如果你需要看更多的
内容, 可以直接跳转到定义处. 一个相似的命令可以被用来检查你是否正确的包含了头文件.

Vim可以分割多个窗口来编辑不同的文件. 然后你能对比两个或多个文件的内容和复制/粘贴
文本在它们当中. 有很多的命令可以打开和关闭窗口, 在它们之间跳转, 临时的隐藏文件等.
然后你就可以使用那三个步骤来从命令集中选择并学习你想要使用的命令.

多窗口有很多的用处. 这个预览标签(preview-tag)机制就是一个很好的例子. 这个机制
可以打开一个预览窗口并让你的光标仍然停留在你正在编辑的文件当中. 例如, 这个
预览窗口将会展示在光标下的函数的描述. 如果你将光标移动到另一个名字上然后
等一小会, 这个预览窗口将会展示另一个名字的定义. 这个名字可以是在你的项目中
include文件中被声明的结构体或函数名.

### 5. 让我们一起工作

一个编辑器是为了编辑文本. 一个e-mail程序是为了发送和接受邮件. 一个操作系统是
为了运行程序. 每一个程序有它自己的任务和应该要做的很好. 将程序结合在一起使用
将会带来强大的力量.

一个简单的例子: 你需要些一个不超过500个单词的摘要. 选中摘要段落, 然后将这个段落
写到"wc"程序中: `vip:w !wc -w`. 这个外部扩展"wc -w"命令用来计算总共有多少个单词.
是不是很简单?

总有一些你需要的但编辑器没有提供的功能. 能够使用外部程序来过滤文本意味着你可以
添加外部扩展方法. Unix的哲学就是让每一个程序做好自己的事然后将它们一起使用来完成
更大的任务. 不幸的是, 很多编辑器并不能很好的和其它程序协同工作-例如, 你不能使用
另一个编辑器来替换网景(Netscape)公司的e-mail编辑器. 你最终使用了一个残缺的编辑器
. 另一个趋势是在编辑器当中包含所有的功能; Emacs就是一个这种趋势的最终走向
(有些人称emacs为能够进行编辑操作的操作系统).

Vim尝试和其它程序进行合作, 但这仍然在奋力开发当中. 现在你已经可以使用Vim作为
MS-Developer Studio和Sniff的编辑器. 一些e-mail程序(像Mutt, 就可以使用Vim作为
外部编辑器)支持使用外部编辑器. Vim现在已经可以很好的和[Sun Workshop](https://docs.oracle.com/cd/E19957-01/806-3564/AboutWkS.html)
协同工作了. 在不远的将来, 这个领域依然有待提升. 直到我们获得一个体系, 它将比
它们各个部分的总和还要强大.

### 6. 结构化文本

你将经常编辑具有一些就够的文本, 然而Vim并不是支持所有的结构化文本. 遇到这种不
支持的情况你就必需去查看这个编辑器的"building blocks", 然后创建你自己的macros和
插件来让其为你的文本工作. 我们现在要讨论更复杂的事情.

第一件比较简单的事情是加快"编辑-编译-修理"循环的速度. Vim有一个`:make`命令
(在编译的时候选择加入)能够捕获它运行是产生的错误并跳转到错误的地方来让你修复
这个错误. 如果你是用一个不同的编译器, 它产生的错误信息将不会被Vim识别.
但你不用自己去写一个插件来实现这个功能, 你只需要调整`errorformat`选项就行了.
这个选项告诉Vim你使用的编辑器产生的错误信息是什么格式和如何从这个格式中提取
文件名和和行号. 这个选项默认支持gcc编译器, 因此你应该修改它让它支持你所使用的
编译器们.

有时设置一个文件类型只需要调整几个选项或写几个宏(macros). 例如, 为了在帮助文档
之间跳转, 你可以写一个宏, 它能捕捉在光标下单词, 清空现在的缓冲区(buffer),
然后把这个单词的帮助文档读到现在的缓冲区(buffer). 这是一个简单并且高效的方法来
查看帮助文档中的交叉引用(cross-references).

只用上面提到的三个步骤, 你能高效的在任何有结构的文件中编辑. 你只需要思考你想要
在这个文件中做什么操作, 然后寻找能完成这件事的编辑命令并开始使用它. 这真得就像
听起来那样简单. 你必需要像这样使用编辑器.

## Part 3: 把它变的更锋利

### 7. 让这样的操作变成习惯

学习开车需要付出努力. 但因为这样就要一直骑自行车吗? 不. 因为你意识到你需要花费
时间来学习一个新的技能. 文本编辑也是一样的. 你需要学习新的命令并让它们变成习惯.

另一方面, 你也不应该尝试去学习编辑器提供的所有命令. 这样做是浪费时间的. 大部分人
只需要学习10%~20%的编辑命令, 就可以完成它们的工作了. 但是每个人要学习的命令是
不同的. 你需要学习的命令取决于你现在和以后的工作环境, 和你是否有能够被自动化的
重复任务. 如果你只做一次这个任务, 然后就再也不会再做它了, 那你根本就没有优化
你做这个任务的方式的必要. 但当你注意到你已经重复做一项任务多次在过去的一小时.
这时你就需要搜索文档来发现一个能让你做这件事更快的命令. 或写一个宏(macro)来
处理它. 当这是一个比较庞大的任务时, 比如排列一种特定格式的文本, 你可以
查看newsgroups或在网络上搜索是否有人已经解决了这个问题.

还有必不可少的最后一步(还有最后一点建议). 你可以现象你有一个重复任务, 然后你
找到了一个很好的解决方案并解决了它, 但是过了几周之后你忘记了你当时是怎么做的了.
这样是不行的. 你必须重复这个解决方案直到你的手指能够不自觉的自动完成它. 这样你
将会发现你达到了你需要的效率. 不要尝试一次学习太多东西. 但是在同一时间少学习
一些是非常好的. 对于你不经常使用的技巧不能够让你熟练的掌握它们, 你可能想要把
它们写下来以便在以后要用的时候可以查看它们. 总之, 如果你时刻保持着这个目标,
你会发现你的编辑操作变得越来越高效.

最后告诉你如果人们忽视上面的建议将会有什么样的情形发生: 我仍然可以看见人们花费
半天的时间在VDU(~~可能是一种面部护理产品~~)后面看着它们的屏幕然后看看两根手指
然后又看向屏幕, 反复这样. -然后他们在想为什么它们会这么累...
使用十根手指进行输入! 这样做不仅快而且厌倦感也比较少. 每天用电脑程序训练一小时,
只需几周的时间就可以学会盲打(touch-type).

## 结语

这个标题的灵感来自于Stephen R. Covey所写的一本畅销书
《The 7 habits of highly effective people》.
我想要把它推荐给每个想要解决个人或专业问题的人(谁不想要呢?).
虽然一些人想说灵感应该是来源于Scott Adams所写的
《Seven years of highly defective people》一书(同样是值得推荐的!).
进入[这个网站](http://iccf-holland.org/click1.html)然后去"recommended books and CDs"这个标签.

## 关于这篇文章的作者

Bram Moolenaar是Vim的主要作者. 他写了Vim的核心功能和选择是否将其他人合并到Vim
主分支中. He graduated at the technical university of Delft as a computer
technician. Now he mainly works on software, but still knows how to handle
a soldering iron. He is founder and treasurer of ICCF Holland, which helps
orphans in Uganda. He does freelance work as a systems architect, but actually
spends most time working on Vim. His e-mail address: Bram AT Moolenaar.net.
